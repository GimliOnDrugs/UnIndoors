<!doctype html>

<html>

    <head>
        <title>Uniboors</title>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- Bootstrap CSS -->
        <link href="css/bootstrap.min.css" rel="stylesheet" />
        <link href="css/loginpagestylesheet.css" rel="stylesheet" />
        <link href="css/classesstylesheet.css" rel="stylesheet" />
        <link href="css/detailclasstylesheet.css" rel="stylesheet" />

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh"
                crossorigin="anonymous"></script>
        <script src="js/bootstrap.js"></script>

        <script href="js/loginpage.js"></script>

        <script src="https://www.gstatic.com/firebasejs/4.8.2/firebase-app.js"></script>
        <script src="https://www.gstatic.com/firebasejs/4.8.2/firebase-auth.js"></script>
        <script src="https://www.gstatic.com/firebasejs/4.8.2/firebase-database.js"></script>
        <script src="https://www.gstatic.com/firebasejs/4.8.2/firebase-firestore.js"></script>
        <script src="https://www.gstatic.com/firebasejs/4.8.2/firebase-messaging.js"></script>
        <script src="js/loginpage.js"></script>
        <script src="js/classeshandler.js">
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.js"></script>
        <script>
            moment().format();
        </script>

        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/tempusdominus-bootstrap-4/5.0.0-alpha14/js/tempusdominus-bootstrap-4.min.js"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tempusdominus-bootstrap-4/5.0.0-alpha14/css/tempusdominus-bootstrap-4.min.css" />
        <script src="js/userstatus.js"></script>


    </head>
    <body>
        <nav class="navbar navbar-dark bg-dark fixed-top navbar-expand-lg">
            <a class="navbar-brand" href="index.html"> Uniboors </a>
            <button id="button_toggle" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#menu_start" aria-controls="menu_start"
                    aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="menu_start">
                <ul class="navbar-nav mr-auto mt-2 mt-lg-0 ">
                    <li class="nav-item">
                        <a class="nav-link" href="MyHelpRequests.html">My Help Requests
                        </a>
                    </li>
                    <li class="nav-item">

                        <a class="nav-link" href="Classes.html">My Classes</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Operators</a>
                    </li>

                </ul>
                <ul class="navbar-nav navbar-right" id="login_signup_navbar">
                    <img src="css/assets/boy.svg" style="width:90px; max-height:65px;">

                </ul>

            </div>
        </nav>

        <div class="container" style="margin-top: 70px; justify-content: center" id="detailcontainer"> 
            <h1 class="display-3 text-center title" style="color: white;" id="class_name" ></h1>


        </div>
        <div class="container collapse" id="directions_container" style="margin-top: 30px;" id="first_direction">

        </div>
        <div class="container" style="margin-top: 70px;" >
            <h1 class="display-2 text-center title" style="color: white;">Next Lessons This Week</h1>
        </div>
        <div class="container-fluid" style="height:100%; margin-top: 15px;">
            <div class="carousel slide" data-ride="carousel" id="carousel_next_classes" >
                <div class="carousel-inner" id="next_classes_inner" ></div>
                <div class="loader loader-classes d-block mx-auto my-auto"  ></div>

                <a class="carousel-control-prev control" href="#carousel_next_classes" role="button" data-slide="prev" id="today_carousel_controls"><span class="carousel-control-prev-icon" aria-hidden="true"></span><span class="sr-only">Previous</span></a><a class="carousel-control-next control" href="#carousel_next_classes" role="button" data-slide="next" id="today_carousel_controls"><span class="carousel-control-next-icon" aria-hidden="true"></span><span class="sr-only">Next</span></a>
            </div>
        </div>

        <script>



            function setNewLayout(){
                var width=$(window).width()
                var container= $('#detailcontainer')
                container.contents(':not(h1)').remove();
                var row=' <div class=" row justify-content-center" style="margin-top: 30px;" >'
                if(width<768){

                    console.log(width)
                    var classToAppend='<div class=" row justify-content-center" style=" margin-top: 50px;" id="class_and_time"><div class="col-4 col-dir icon_wrapper justify-content-center align-self-center" style="margin-left: 50px; margin-top:30px"><img  class="icon" src="css/assets/classroom.svg" ></div><div class="col col-dir align-self-center " style="margin-top: 30px;" ><div class="loader d-block mx-auto my-auto"  ></div><p class="detail display-4 text-left text-capitalize " id="classroom_name" style="color: white;"></p></div>'
                    var clock=' <div class="col-4 col-dir  justify-content-center align-self-center icon_wrapper"  style="margin-left:50px; margin-top:30px"><img  class="icon" src="css/assets/clock.svg" ></div><div class="col col-dir  align-self-center "  style=" margin-top: 30px;"><div class="loader d-block mx-auto my-auto"  ></div><p class="detail  display-4 text-left text-capitalize" id="time_and_day" style="color: white;"></p></div>'
                    var teacher='<div class="col-4 col-dir justify-content-center align-self-center icon_wrapper "style="margin-left:50px; margin-top:30px"><img  class="icon"  src="css/assets/teacher.svg"></div><div class="col col-dir  align-self-center " style="margin-top: 30px;"><div class="loader d-block mx-auto my-auto"  ></div><p class="detail display-4 text-left text-capitalize" id="teacher_name" style="color: white;"></p></div>'
                    var handy='<div class="col-4 col-dir  justify-content-center align-self-center icon_wrapper"style="margin-left:50px; margin-top:30px"><img  class="icon" src="css/assets/handicapped.svg" id="handy" ></div><div class="col col-dir  align-self-center " style="margin-top: 30px;"><div class="loader d-block mx-auto my-auto"  ></div><p class="detail display-4 text-left text-capitalize" id="is_friendly" style="color: white;"></p></div><div class="container" id="help_request" style="max-width: 600px; margin-top:30px;"></div>'
                    var map='<div class="col-4 col-dir  justify-content-center align-self-center icon_wrapper" style="margin-left:50px; margin-top:0px"><img  class="icon" src="css/assets/map.svg" ></div><div class="col col-dir  align-self-center " style="margin-top: 30px;"><div class="loader d-block mx-auto my-auto"  ></div><p class=" detail display-4 text-left text-capitalize" id="position" style="color: white;"></p></div>'
                    var directions='<div class="col-4 col-dir justify-content-center align-self-center icon_wrapper" style="margin-left:50px; margin-top:30px"><img class="icon" src="css/assets/panel.svg" ></div><div class="col col-dir align-self-center " style="margin-top: 30px;"><button type="button" class="btn btn-success btn-lg " id="getdirections" onclick="getClassroomDirections()" data-toggle="collapse" data-target="#directions_container" aria-expanded="false" aria-controls="directions_container">Get directions!</button></div></div>'
                    container.append(classToAppend)
                    container.append(row)
                    var rowAppended=$('#detailcontainer').find('.row').last()
                    rowAppended.append(clock)
                    container.append(row)
                    rowAppended=$('#detailcontainer').find('.row').last()
                    rowAppended.append(teacher)
                    container.append(row)
                    rowAppended=$('#detailcontainer').find('.row').last()
                    rowAppended.append(handy)
                    container.append(row)
                    rowAppended=$('#detailcontainer').find('.row').last()
                    rowAppended.append(map)
                    container.append(row)
                    rowAppended=$('#detailcontainer').find('.row').last()
                    rowAppended.append(directions)






                }else{
                    console.log('greater  '+width)
                    var container= $('#detailcontainer')

                    var elements='<div class=" row justify-content-center" style="margin-top: 50px;" id="class_and_time"><div class="col-2 col-dir icon_wrapper justify-content-center align-self-center" style="margin-left: 50px; margin-top:30px"><img  class="icon" src="css/assets/classroom.svg" ></div>    <div class="col col-dir  align-self-center " style="margin-top: 30px;" ><div class="loader d-block mx-auto my-auto"  ></div><p class="detail display-4 text-left text-capitalize " id="classroom_name" style="color: white;"></p></div><div class="col-2 col-dir justify-content-center align-self-center icon_wrapper"  style="margin-left: 50px; margin-top:30px"><img  class="icon" src="css/assets/clock.svg" ></div><div class="col col-dir  align-self-center "  style="margin-top: 30px;"><div class="loader d-block mx-auto my-auto"  ></div><p class="detail  display-4 text-left text-capitalize" id="time_and_day" style="color: white;"></p></div></div><div class="row justify-content-center" ><div class="col-2 col-dir justify-content-center align-self-center icon_wrapper "style="margin-left: 50px; margin-top:30px"><img  class="icon"  src="css/assets/teacher.svg"></div><div class="col col-dir  align-self-center " style="margin-top: 30px;"><div class="loader d-block mx-auto my-auto"  ></div><p class="detail display-4 text-left text-capitalize" id="teacher_name" style="color: white;"></p></div><div class="col-2 justify-content-center align-self-center icon_wrapper col-dir "style="margin-left: 50px; margin-top:30px"><img  class="icon" src="css/assets/handicapped.svg" id="handy" ></div><div class="col col-dir  align-self-center " style="margin-top: 30px;"><div class="loader d-block mx-auto my-auto"  ></div><p class="detail display-4 text-left text-capitalize" id="is_friendly" style="color: white;"></p></div></div><div class="container" id="help_request" style="max-width: 600px; margin-top:30px" ></div><div class="row justify-content-center"><div class="col-2 col-dir justify-content-center align-self-center icon_wrapper" style="margin-left: 50px; margin-top:30px"><img  class="icon" src="css/assets/map.svg" ></div><div class="col col-dir  align-self-center " style="margin-top: 30px;"><div class="loader d-block mx-auto my-auto"  ></div> <p class=" detail display-4 text-left text-capitalize" id="position" style="color: white;"></p></div><div class="col-2 col-dir  justify-content-center align-self-center icon_wrapper" style="margin-left: 50px; margin-top:30px"><img class="icon" src="css/assets/panel.svg" ></div><div class="col col-dir  align-self-center " style="margin-top: 30px;"><button type="button" class="btn btn-success btn-lg " id="getdirections" onclick="getClassroomDirections()" data-toggle="collapse" data-target="#directions_container" aria-expanded="false" aria-controls="directions_container">Get directions!</button></div></div>'

                    container.append(elements)
                }
                return true
            }



            function getClassroomDirections(){
                var directionDiv=$('#directions_container')


                if(directionDiv.children().length==0){

                    var database = firebase.database();
                    var todayClass=JSON.parse(localStorage.getItem('todayclass'))
                    var classroomName=todayClass.place
                    database.ref('CesenaCampus/'+classroomName+'/directions/').on('value',function (snapshot){
                        var newRow='<div class="row justify-content-center " style="margin-top: 50px;" ></div>'
                        var firstDirection='<div class="col-3 icon_wrapper justify-content-center align-self-center" style="margin-left: 30px; margin-top:30px" ><img class="icon" src="css/assets/entrance.svg" ></div><div class="col align-self-center " style="margin-top: 30px;" ><p class="detail display-4 text-left "style="color: white;">Walk through the main gate</p></div>'
                        directionDiv.append(newRow)
                        var row=directionDiv.find('.row').last()
                        row.append(firstDirection)
                        snapshot.forEach(function(childSnapshot){
                            var directionKey=childSnapshot.key

                            if(directionKey.includes('left')){
                                var row=directionDiv.find('.row').last()
                                if(row.children().length==2){
                                    directionDiv.append(newRow)
                                    row=directionDiv.find('.row').last()
                                    var cols='<div class="col-3 icon_wrapper justify-content-center align-self-center" style="margin-left: 30px; margin-top:30px"><img  class="icon" src="css/assets/left.svg" ></div><div class="col align-self-center " style="margin-top: 30px;" ><p class="detail display-4 text-left "  style="color: white;">'+childSnapshot.val().toString()+'</p></div>'
                                    row.append(cols)

                                }
                                else{
                                    var cols='<div class="col-3 icon_wrapper justify-content-center align-self-center" style="margin-left: 30px; margin-top:30px"><img  class="icon" src="css/assets/left.svg" ></div><div class="col align-self-center " style="margin-top: 30px;" ><p class="detail display-4 text-left "  style="color: white;">'+childSnapshot.val().toString()+'</p></div>'
                                    row.append(cols) 
                                }
                            }

                            if(directionKey.includes('stairsup')){
                                var row=directionDiv.find('.row').last()
                                if(row.children().length==2){
                                    directionDiv.append(newRow)
                                    row=directionDiv.find('.row').last()
                                    var cols='<div class="col-3 icon_wrapper justify-content-center align-self-center" style="margin-left:30px; margin-top:30px"><img  class="icon" src="css/assets/stairs-up.svg" ></div><div class="col align-self-center " style="margin-top: 30px;" ><p class="detail display-4 text-left "  style="color: white;">'+childSnapshot.val().toString()+'</p></div>'
                                    row.append(cols)

                                }
                                else{
                                    var cols='<div class="col-3 icon_wrapper justify-content-center align-self-center" style="margin-left: 30px; margin-top:30px"><img  class="icon" src="css/assets/stairs-up.svg" ></div><div class="col align-self-center " style="margin-top: 30px;" ><p class="detail display-4 text-left "   style="color: white;">'+childSnapshot.val().toString()+'</p></div>'
                                    row.append(cols) 
                                }
                            }
                            if(directionKey.includes('final')){
                                var row=directionDiv.find('.row').last()
                                if(row.children().length==2){
                                    directionDiv.append(newRow)
                                    row=directionDiv.find('.row').last()
                                    var cols='<div class="col-3 icon_wrapper justify-content-center align-self-center" style="margin-left: 30px; margin-top:30px"><img  class="icon" src="css/assets/destination.svg" ></div><div class="col align-self-center " style="margin-top: 30px;" ><p class="detail display-4 text-left "  style="color: white;">'+childSnapshot.val().toString()+'</p></div>'
                                    row.append(cols)

                                }
                                else{
                                    var cols='<div class="col-3 icon_wrapper justify-content-center align-self-center" style="margin-left: 30px; margin-top:30px"><img  class="icon" src="css/assets/destination.svg" ></div><div class="col align-self-center " style="margin-top: 30px;" ><p class="detail display-4 text-left "   style="color: white;">'+childSnapshot.val().toString()+'</p></div>'
                                    row.append(cols) 
                                }
                            }
                            if(directionKey.includes('straight')){
                                var row=directionDiv.find('.row').last()
                                if(row.children().length==2){
                                    directionDiv.append(newRow)
                                    row=directionDiv.find('.row').last()
                                    var cols='<div class="col-3 icon_wrapper justify-content-center align-self-center" style="margin-left: 30px; margin-top:30px"><img  class="icon" src="css/assets/up.svg" ></div><div class="col align-self-center " style="margin-top: 30px;" ><p class="detail display-4 text-left "  style="color: white;">'+childSnapshot.val().toString()+'</p></div>'
                                    row.append(cols)

                                }
                                else{
                                    var cols='<div class="col-3 icon_wrapper justify-content-center align-self-center" style="margin-left: 30px; margin-top:30px"><img  class="icon" src="css/assets/up.svg" ></div><div class="col align-self-center " style="margin-top: 30px;" ><p class="detail display-4 text-left "   style="color: white;">'+childSnapshot.val().toString()+'</p></div>'
                                    row.append(cols) 
                                }
                            }
                            if(directionKey.includes('right')){
                                var row=directionDiv.find('.row').last()
                                if(row.children().length==2){
                                    directionDiv.append(newRow)
                                    row=directionDiv.find('.row').last()
                                    var cols='<div class="col-3 icon_wrapper justify-content-center align-self-center" style="margin-left: 30px; margin-top:30px"><img  class="icon" src="css/assets/right.svg" ></div><div class="col align-self-center " style="margin-top: 30px;" ><p class="detail display-4 text-left "  style="color: white;">'+childSnapshot.val().toString()+'</p></div>'
                                    row.append(cols)

                                }
                                else{
                                    var cols='<div class="col-3 icon_wrapper justify-content-center align-self-center" style="margin-left: 30px; margin-top:30px"><img  class="icon" src="css/assets/right.svg" ></div><div class="col align-self-center " style="margin-top: 30px;" ><p class="detail display-4 text-left "   style="color: white;">'+childSnapshot.val().toString()+'</p></div>'
                                    row.append(cols)    
                                }
                            }
                        })
                        var width=$(window).width()
//                        var positionY = $('#first_direction').offset().top;
//                        $("html, body").animate({ scrollTop: positionY }, 500);
                        resize(width)

                    })



                }
            }

            $( document ).ready(function() {
                var width=$( window ).width();

                var value=JSON.parse(localStorage.getItem('todayclass'))
                console.log(value)
                $('#class_name').text(value.name)
                getPlaceDetails(value)
                setNewLayout()
                setUpTodayClasses(width)
              //  resize(width)





            });


            $(window).resize(function(){
                var width=$( window ).width();
                resize(width)
                if(width<=768){

                    setNewLayout()
                    var value=JSON.parse(localStorage.getItem('todayclass'))
                    console.log(value)
                    $('#class_name').text(value.name)
                    getPlaceDetails(value)
                    setUpTodayClasses(width)
                    resize(width)
                }
                else{

                    setNewLayout()
                    var value=JSON.parse(localStorage.getItem('todayclass'))
                    console.log(value)
                    $('#class_name').text(value.name)
                    getPlaceDetails(value)
                    setUpTodayClasses(width)
                    resize(width)
                }


            })


        </script>


    </body>
</html>