<!doctype html>

<html>

    <head>
        <title>Uniboors</title>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- Bootstrap CSS -->
        <link href="css/bootstrap.min.css" rel="stylesheet" />
        <link href="css/loginpagestylesheet.css" rel="stylesheet" />
        <link href="css/classesstylesheet.css" rel="stylesheet" />
        <link href="css/detailclassstylesheet.css" rel="stylesheet" />

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh"
                crossorigin="anonymous"></script>
        <script src="js/bootstrap.js"></script>

        <script href="js/loginpage.js"></script>

        <script src="https://www.gstatic.com/firebasejs/4.6.2/firebase-app.js"></script>
        <script src="https://www.gstatic.com/firebasejs/4.6.2/firebase-auth.js"></script>
        <script src="https://www.gstatic.com/firebasejs/4.6.2/firebase-database.js"></script>
        <script src="https://www.gstatic.com/firebasejs/4.6.2/firebase-firestore.js"></script>
        <script src="https://www.gstatic.com/firebasejs/4.6.2/firebase-messaging.js"></script>
        <script src="https://www.gstatic.com/firebasejs/4.6.2/firebase.js"></script>
        <script src="js/loginpage.js"></script>
        <script src="js/classeshandler.js">
        </script>


    </head>
    <body>
        <nav class="navbar navbar-dark bg-dark fixed-top navbar-expand-lg">
            <a class="navbar-brand" href="index.html"> Uniboors </a>
            <button id="button_toggle" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#menu_start" aria-controls="menu_start"
                    aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="menu_start">
                <ul class="navbar-nav mr-auto mt-2 mt-lg-0 ">
                    <li class="nav-item">
                        <a class="nav-link" href="#">Features
                        </a>
                    </li>
                    <li class="nav-item">

                        <a class="nav-link" href="Classes.html">My Classes</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Operators</a>
                    </li>

                </ul>
                <ul class="navbar-nav navbar-right" id="login_signup_navbar">
                    <img src="css/assets/boy.svg" style="width:90px; max-height:65px;">

                </ul>

            </div>
        </nav>
        <div class="container" style="margin-top: 70px; justify-content: center" >
            <h1 class="display-3 text-center title" style="color: white;" id="class_name"></h1>
            <div class=" row justify-content-center" style="margin-top: 50px;">
                <div class="col-2 icon_wrapper" style="margin-left: 50px; margin-top:30px"><img  class="icon" src="css/assets/classroom.svg" ></div>
                <div class="col align-self-center " style="margin-top: 30px;" ><p class="detail display-4 text-left text-capitalize " id="classroom_name" style="color: white;"></p></div>

                <div class="col-2 align-self-center icon_wrapper"  style="margin-left: 50px; margin-top:30px"><img  class="icon" src="css/assets/clock.svg" ></div>
                <div class="col align-self-center "  style="margin-top: 30px;"><p class="detail  display-4 text-left text-capitalize" id="time_and_day" style="color: white;"></p></div>
            </div>
            <div class="row justify-content-center" >
                <div class="col-2 align-self-center icon_wrapper "style="margin-left: 50px; margin-top:30px"><img  class="icon"  src="css/assets/teacher.svg"></div>
                <div class="col align-self-center " style="margin-top: 30px;"><p class="detail display-4 text-left text-capitalize" id="teacher_name" style="color: white;"></p></div>
                <div class="col-2 align-self-center icon_wrapper"style="margin-left: 50px; margin-top:30px"><img  class="icon" src="css/assets/handicapped.svg" id="handy"></div>
                <div class="col align-self-center " style="margin-top: 30px;"><p class="detail display-4 text-left text-capitalize" id="is_friendly" style="color: white;"></p></div>
            </div>
            <div class="row justify-content-center">
                <div class="col-2 align-self-center icon_wrapper" style="margin-left: 50px; margin-top:30px"><img  class="icon" src="css/assets/map.svg" ></div>
                <div class="col align-self-center " style="margin-top: 30px;"><p class=" detail display-4 text-left text-capitalize" id="position" style="color: white;"></p></div>
                <div class="col-2 align-self-center icon_wrapper" style="margin-left: 50px; margin-top:30px"><img class="icon" src="css/assets/panel.svg" ></div>
                <div class="col align-self-center " style="margin-top: 30px;"><button type="button" class="btn btn-success btn-lg " id="getdirections" onclick="getClassroomDirections()" data-toggle="collapse" data-target="#directions_container" aria-expanded="false" aria-controls="directions_container">Get directions!</button></div>
            </div>
        </div>
        <div class="container collapse" id="directions_container"></div>
        <div class="container" style="margin-top: 70px;" >
            <h1 class="display-2 text-center title" style="color: white;">Next Lessons This Week</h1>
        </div>
        <div class="container-fluid" style="height:100%; margin-top: 15px;">
            <div class="carousel slide" data-ride="carousel" id="carousel_next_classes" >
                <div class="carousel-inner" id="next_classes_inner" ></div>
                <a class="carousel-control-prev control" href="#carousel_next_classes" role="button" data-slide="prev" id="today_carousel_controls"><span class="carousel-control-prev-icon" aria-hidden="true"></span><span class="sr-only">Previous</span></a><a class="carousel-control-next control" href="#carousel_next_classes" role="button" data-slide="next" id="today_carousel_controls"><span class="carousel-control-next-icon" aria-hidden="true"></span><span class="sr-only">Next</span></a>
            </div>
        </div>
        <script>
            function getClassroomDirections(){
                var directionDiv=$('#directions_container')

                if(directionDiv.children().length==0){

                    var database = firebase.database();
                    var todayClass=JSON.parse(localStorage.getItem('todayclass'))
                    var classroomName=todayClass.place
                    console.log('hi '+classroomName)
                    database.ref('CesenaCampus/'+classroomName+'/directions/').on('value',function (snapshot){
                        var newRow='<div class="row justify-content-center " style="margin-top: 50px;"></div>'
                        var firstDirection='<div class="col-2 icon_wrapper justify-content-center align-self-center" style="margin-left: 50px; margin-top:30px"><img class="icon" src="css/assets/entrance.svg" ></div><div class="col align-self-center " style="margin-top: 30px;" ><p class="detail display-4 text-left "style="color: white;">Walk through the main gate</p></div>'
                        directionDiv.append(newRow)
                        var row=directionDiv.find('.row').last()
                        row.append(firstDirection)
                        console.log('first row '+row.children().length)
                        snapshot.forEach(function(childSnapshot){
                            var directionKey=childSnapshot.key

                            if(directionKey.includes('left')){
                                var row=directionDiv.find('.row').last()
                                console.log('lets see the row length '+row.children().length)
                                if(row.children().length==2){
                                    directionDiv.append(newRow)
                                    row=directionDiv.find('.row').last()
                                    var cols='<div class="col-2 icon_wrapper justify-content-center align-self-center" style="margin-left: 50px; margin-top:30px"><img  class="icon" src="css/assets/left.svg" ></div><div class="col align-self-center " style="margin-top: 30px;" ><p class="detail display-4 text-left "  style="color: white;">'+childSnapshot.val().toString()+'</p></div>'
                                    row.append(cols)

                                }
                                else{
                                    var cols='<div class="col-2 icon_wrapper justify-content-center align-self-center" style="margin-left: 50px; margin-top:30px"><img  class="icon" src="css/assets/left.svg" ></div><div class="col align-self-center " style="margin-top: 30px;" ><p class="detail display-4 text-left "  style="color: white;">'+childSnapshot.val().toString()+'</p></div>'
                                    row.append(cols) 
                                }
                            }

                            if(directionKey.includes('stairsup')){
                                var row=directionDiv.find('.row').last()
                                console.log(row.length)
                                if(row.children().length==2){
                                    directionDiv.append(newRow)
                                    row=directionDiv.find('.row').last()
                                    var cols='<div class="col-2 icon_wrapper justify-content-center align-self-center" style="margin-left: 50px; margin-top:30px"><img  class="icon" src="css/assets/stairs-up.svg" ></div><div class="col align-self-center " style="margin-top: 30px;" ><p class="detail display-4 text-left "  style="color: white;">'+childSnapshot.val().toString()+'</p></div>'
                                    row.append(cols)

                                }
                                else{
                                    var cols='<div class="col-2 icon_wrapper justify-content-center align-self-center" style="margin-left: 50px; margin-top:30px"><img  class="icon" src="css/assets/stairs-up.svg" ></div><div class="col align-self-center " style="margin-top: 30px;" ><p class="detail display-4 text-left "   style="color: white;">'+childSnapshot.val().toString()+'</p></div>'
                                    row.append(cols) 
                                }
                            }
                            if(directionKey.includes('final')){
                                var row=directionDiv.find('.row').last()
                                console.log(row.length)
                                if(row.children().length==2){
                                    directionDiv.append(newRow)
                                    row=directionDiv.find('.row').last()
                                    var cols='<div class="col-2 icon_wrapper justify-content-center align-self-center" style="margin-left: 50px; margin-top:30px"><img  class="icon" src="css/assets/destination.svg" ></div><div class="col align-self-center " style="margin-top: 30px;" ><p class="detail display-4 text-left "  style="color: white;">'+childSnapshot.val().toString()+'</p></div>'
                                    row.append(cols)

                                }
                                else{
                                    var cols='<div class="col-2 icon_wrapper justify-content-center align-self-center" style="margin-left: 50px; margin-top:30px"><img  class="icon" src="css/assets/destination.svg" ></div><div class="col align-self-center " style="margin-top: 30px;" ><p class="detail display-4 text-left "   style="color: white;">'+childSnapshot.val().toString()+'</p></div>'
                                    row.append(cols) 
                                }
                            }
                            if(directionKey.includes('straight')){
                                var row=directionDiv.find('.row').last()
                                console.log(row.length)
                                if(row.children().length==2){
                                    directionDiv.append(newRow)
                                    row=directionDiv.find('.row').last()
                                    var cols='<div class="col-2 icon_wrapper justify-content-center align-self-center" style="margin-left: 50px; margin-top:30px"><img  class="icon" src="css/assets/up.svg" ></div><div class="col align-self-center " style="margin-top: 30px;" ><p class="detail display-4 text-left "  style="color: white;">'+childSnapshot.val().toString()+'</p></div>'
                                    row.append(cols)

                                }
                                else{
                                    var cols='<div class="col-2 icon_wrapper justify-content-center align-self-center" style="margin-left: 50px; margin-top:30px"><img  class="icon" src="css/assets/up.svg" ></div><div class="col align-self-center " style="margin-top: 30px;" ><p class="detail display-4 text-left "   style="color: white;">'+childSnapshot.val().toString()+'</p></div>'
                                    row.append(cols) 
                                }
                            }
                            if(directionKey.includes('right')){
                                var row=directionDiv.find('.row').last()
                                console.log(row.length)
                                if(row.children().length==2){
                                    directionDiv.append(newRow)
                                    row=directionDiv.find('.row').last()
                                    var cols='<div class="col-2 icon_wrapper justify-content-center align-self-center" style="margin-left: 50px; margin-top:30px"><img  class="icon" src="css/assets/right.svg" ></div><div class="col align-self-center " style="margin-top: 30px;" ><p class="detail display-4 text-left "  style="color: white;">'+childSnapshot.val().toString()+'</p></div>'
                                    row.append(cols)

                                }
                                else{
                                    var cols='<div class="col-2 icon_wrapper justify-content-center align-self-center" style="margin-left: 50px; margin-top:30px"><img  class="icon" src="css/assets/right.svg" ></div><div class="col align-self-center " style="margin-top: 30px;" ><p class="detail display-4 text-left "   style="color: white;">'+childSnapshot.val().toString()+'</p></div>'
                                    row.append(cols) 
                                }
                            }
                        })
                        var width=$(window).width()

                        resize(width)

                    })



                }
            }
            function resize(width){
                if(width>=1000){
                    var title=jQuery('.title')
                    var col=jQuery('.icon_wrapper')

                    console.log('ciaone '+getDirectionsButton)


                    if(title.hasClass('display-3')){

                        title.removeClass('display-3')
                        title.addClass('display-2')
                    }
                    if(col.hasClass('col-4')){
                        col.removeClass('col-4')
                        col.addClass('col-2 ')
                    }



                }
                if(width>=768 && width<1000){
                    var title=jQuery('.title')
                    var col=jQuery('.icon_wrapper')

                    if(title.hasClass('display-2')){
                        title.removeClass('display-2')
                        title.addClass('display-3')
                    }
                    else{
                        title.removeClass('display-4')
                        title.addClass('display-3')
                    }
                    if(col.hasClass('col-4')){
                        console.log("hi come stai")
                        col.removeClass('col-4')
                        col.addClass('col-2 ')
                    }

                }
                if(width<768){
                    var title=jQuery('.title')
                    var col=jQuery('.icon_wrapper')

                    if(title.hasClass('display-3')){
                        title.removeClass('display-3')
                        title.addClass('display-4')
                    }
                    if(title.hasClass('display-2')){
                        title.removeClass('display-2')
                        title.addClass('display-4')
                    }
                    if(col.hasClass('col-2')){
                        col.removeClass('col-2')
                        col.addClass('col-4 ')
                    }

                }
                var getDirectionsButton=jQuery('#getdirections')
                if(width<400 && getDirectionsButton.hasClass('btn-lg')){
                    getDirectionsButton.removeClass('btn-lg')

                }
            }
            $( document ).ready(function() {
                var width=$( window ).width();

                var value=JSON.parse(localStorage.getItem('todayclass'))
                console.log(value)
                $('#class_name').text(value.name)
                getPlaceDetails(value)
                setUpTodayClasses(width)
                resize(width)





            });
            $(window).resize(function(){
                var width=$( window ).width();
                resize(width)

            })


        </script>
    </body>
</html>